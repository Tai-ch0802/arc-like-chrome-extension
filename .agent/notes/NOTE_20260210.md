# 開發摘要 - 2026-02-10

## 變更項目
- [modules/rssManager.js]: 修復 RSS 訂閱新增失敗的問題。新增 `parseRssFeedXml()` 本地解析函數（含 `getTextContent`、`getAtomLink`、`getLinkFromGuid` 輔助函數），修改 `fetchRssFeed()` 根據 `typeof DOMParser` 偵測執行環境，在 side panel 使用本地解析，在 service worker 維持 offscreen document 路徑。

## 技術決策
- **根因**：`fetchRssFeed()` 原始設計僅考慮 service worker 環境（透過 offscreen document 解析 XML），但此函數也從 side panel 呼叫（`addSubscription`），在 side panel 的 `chrome.runtime.sendMessage()` 會被 `background.js` 的 listener 攔截，且因為 listener 未 return `true` 導致訊息通道關閉，offscreen document 的回應無法送回。
- **解決方案**：利用 `typeof DOMParser !== 'undefined'` 判斷環境。Side panel 有完整 DOM API，直接本地解析 XML；service worker 沒有 DOMParser，才使用 offscreen document。
- **不修改 background.js**：原始 `onMessage` listener 不 return `true` 是正確行為（不處理的 action 不應保持通道開放），根本問題應在來源端解決。

## 待辦事項
- [ ] 手動測試：在 Chrome 載入擴充功能，驗證 RSS 訂閱新增功能正常
- [ ] 考慮未來將 `offscreen.js` 的解析邏輯與 `rssManager.js` 的本地解析邏輯統一（避免重複維護）
