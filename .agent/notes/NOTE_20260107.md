# 2026-01-07 開發筆記

## 修正搜尋列清除行為

### 問題描述
側邊欄搜尋框在輸入內容後清除 (清空字串)，書籤區塊沒有恢復為預設的完整書籤樹，而是呈現空白狀態 (類似搜尋空字串無結果)。

### 解決方案
在 `modules/searchManager.js` 中引入狀態變數 `isFiltering` 來追蹤目前是否處於過濾狀態。
當 `filterBookmarks` 接收到空關鍵字 (`keywords.length === 0`) 時：
1. 檢查 `isFiltering` 是否為 `true`。
2. 若為 `true`，代表使用者剛結束搜尋，發送 `refreshBookmarksRequired` 事件以觸發全域書籤刷新。
3. 將 `isFiltering` 重置為 `false`。

此修改確保了當搜尋結束時，UI 能正確切換回預設的書籤列表視圖。

### 修改檔案
- `modules/searchManager.js`

## 新增功能：其他視窗分頁 (Other Windows Tabs)

### 功能描述
在側邊欄顯示 "Other Windows" 區塊，列出其他已開啟的 Chrome 視窗及其分頁，方便使用者跨視窗檢視與切換。此區塊設計為唯讀，不允許拖曳操作。

### 實作細節
1. **規格制定**: 撰寫 `docs/feat-spec/002_other_windows_tabs.md`，定義三種語言的功能需求。
2. **唯讀保護**: 修改 `modules/dragDropManager.js`，將 SortableJS 的初始化範圍縮小至 `ui.tabListContainer` 與 `ui.bookmarkListContainer`，排除 "Other Windows" 區塊，防止意外拖曳。
3. **測試**: 新增 `usecase_tests/puppeteer_tests/other_windows.test.js`，驗證分頁顯示正確且無法拖曳。

### 修改檔案
- `docs/feat-spec/002_other_windows_tabs.md`
- `modules/dragDropManager.js`
- `usecase_tests/puppeteer_tests/other_windows.test.js`

## 錯誤修復：Stale Link Icon 清除

### 問題描述
當已連結書籤的分頁被關閉後，書籤上的連結圖示 (Link Icon) 仍然存在。點擊後會開啟空白清單。

### 解決方案
1. **偵測與清理**: 修改 `modules/ui/bookmarkRenderer.js` 的 `showLinkedTabsPanel`，當偵測到儲存的 Tab ID 對應的分頁已不存在時，自動清除連結狀態。
2. **UI 優化**: 顯示 "No Linked Tabs" 對話框，並在 5 秒後自動關閉並刷新 UI，移除連結圖示。
3. **i18n**: 新增 `autoCloseDialog` 翻譯字串至所有支援的 14 種語言 (`_locales/*/messages.json`)，確保提示訊息在地化。

### 修改檔案
- `modules/ui/bookmarkRenderer.js`
- `_locales/*/messages.json`

## 程式碼清理 (Code Cleanup)

### 執行項目
盤點並移除了專案中過時、無意義或用於除錯的註解，提升程式碼品質。
1. **`themeManager.js`**: 移除 `// DEBUG` console logs。
2. **`bookmarkRenderer.js`**: 移除 "Legacy Renderer" 等過時註解。
3. **`sidepanel.js`**: 清理初始化相關的冗餘註解。
4. **`modalManager.js`**: 移除無用的樣式註解。
5. **Release**: 更新版本號至 `1.10.0` 並建立 Release Build。

### 修改檔案
- `modules/ui/themeManager.js`
- `modules/ui/bookmarkRenderer.js`
- `sidepanel.js`
- `modules/modalManager.js`
- `manifest.json`
