# PRD: 魔法一鍵整理 (Smart Auto-Grouping)

## 1. 產品概述 (Overview)
- **目標 (What)**: 透過單一按鈕觸發本地 AI (Chrome 內建 Gemini Nano)，將側邊欄中未分類的分頁自動依語意分類，並收攏至具備描述性標題的群組 (Tab Groups) 中。
- **價值 (Why)**: 解決重度使用者開啟大量分頁導致的視覺壅塞與尋找困難，降低手動分類的摩擦力，提升工作區的整潔度。

## 2. 目標受眾與場景 (Audience & Scenarios)
- **受眾**: 需要同時進行多工處理、資料搜集的知識工作者與開發者。
- **場景**: 使用者經過一小時的資料搜集，側邊欄累積了 15 個不同主題（如 API 文件、新聞、購物）的分頁。點擊按鈕後，分頁自動被打包成 3 個整齊的資料夾。

## 3. 使用者故事 (User Stories)
- **US-01**: 身為一位重度資料搜集者，我希望能一鍵將大量未分類的分頁自動依主題分組，以便能快速找回相關資料，且讓側邊欄保持整潔。
- **US-02**: 身為一位進階使用者，我希望在執行自動分組後能有「復原 (Undo)」的選項，萬一 AI 分類的結果不如預期，我可以安全地還原到整理前的狀態。

## 4. 系統邊界 (Scope)
- **In-Scope**:
  - 觸發整理的 UI 進入點。
  - 對當前視窗中「未分類」的分頁進行語意分析 (擷取標題與網址)。
  - 自動建立分頁群組並命名 (Emoji + 簡短主題)。
  - 提供還原上一動的復原 (Undo) 機制。
- **Out-of-Scope**:
  - 跨視窗 (Cross-window) 的分頁同步與合併。
  - 自動關閉或休眠任何分頁。
  - 已在群組內的分頁不參與重組。
  - 手動微調 AI 分類規則。

## 5. 功能需求 (Functional Requirements)
| 需求編號 | 需求描述 | 優先級 |
| :--- | :--- | :--- |
| FR-1.01 | 系統應於側邊欄明顯處提供「✨ 智慧整理」之操作入口。 | High |
| FR-1.02 | 系統應於未分類分頁數量低於 4 個時，在點擊後給予防呆提示且不執行分類。 | Medium |
| FR-1.03 | 系統應於執行分類時，擷取當前所有未分類分頁之「標題」與「網址」做為 Prompt 來源。 | High |
| FR-1.04 | 系統應於處理期間提供明確的 Loading 視覺狀態（如按鈕顯示 Spinner 或漸層動畫），避免重複點擊。 | High |
| FR-1.05 | 系統應透過 Gemini Nano 將分頁歸類為 3~5 個主題群組，並以「1 個 Emoji + 簡短主題名稱」進行命名。 | High |
| FR-1.06 | 系統應於 AI 處理完成後，將分頁自動移入對應新建的 Chrome 分頁群組 (Tab Groups) 中。 | High |
| FR-1.07 | 系統應於完成整理後顯示成功提示 (Toast/Snackbar)，並同時提供「復原 (Undo)」選項。 | High |
| FR-1.08 | 系統應於使用者點擊復原時，解散該次建立的群組並恢復對應分頁至未分類狀態。 | High |

## 6. 非功能需求 (Non-Functional Requirements)
- **隱私 (Privacy)**: 必須 100% 使用 Chrome 內建之 `window.ai` (Gemini Nano) 本地端模型。嚴禁將任何分頁資料傳送至外部伺服器。
- **效能 (Performance)**: 從觸發至分類完成的 UI 變化，必須在 3~5 秒內完成。若分頁數過多，需截斷文字以避免超出模型 Token 限制。

## 7. 驗收標準 (Acceptance Criteria)
- **AC-1: 成功整理**
  - **Given** 當前有 10 個未分類的相關分頁且 Gemini 模型已就緒
  - **When** 點擊「✨ 智慧整理」按鈕
  - **Then** 系統在 5 秒內將 10 個分頁移入 2~4 個帶有 Emoji 名稱的群組，並顯示包含復原按鈕的成功提示
- **AC-2: 數量不足防呆**
  - **Given** 當前僅有 2 個未分類分頁
  - **When** 點擊整理按鈕
  - **Then** 系統顯示「分頁數量過少，無需整理」，且不呼叫 AI 模型 API
- **AC-3: 觸發復原機制**
  - **Given** 系統剛完成一次自動分類，畫面上顯示成功提示與 Undo 按鈕
  - **When** 使用者點擊「復原 (Undo)」按鈕
  - **Then** 剛被歸類的分頁恢復為未分類狀態，且本次新建的空群組被自動移除

## 8. 成功指標 (Success Metrics)
- 整體使用率：用戶每日主動點擊整理按鈕的活躍度。
- 模型滿意度：成功整理後，未觸發「復原」按鈕的比例超過 80%。
